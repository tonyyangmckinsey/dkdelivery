To-do: Link delivered MRC with the Order Development Output sheet
Flow analysis

1. metric_avg_days_in_step

For each step, calculate how many days (on average) an order stays in that step before transitioning to another step.

It's calculating, per delivery step, the average number of consecutive days an order spends in that step before transitioning to a new one.
It loops through each row (i.e., each order), looks across all the daily columns, and counts how long an order stays in the same step, like this:

Cabling  → Cabling → Cabling → Activation → Activation → RFS
           ↑      ↑      ↑        ↑         ↑         ↑
         Day 1   2      3       4         5         6


In this case:
Cabling = 3 days
Activation = 2 days
RFS = 1 day

These durations are added to totals per step

Another example:
If 50 orders each spend 3 days in a step → average is 3
If 10 orders spend 1 day, 10 spend 5 → average = (10×1 + 10×5) / 20 = 3

Order	Timeline
001	Planning → Planning → Digging
002	Planning → Planning → Planning
003	Planning → Digging → Digging

For Planning:
Order 1: 2 days
Order 2: 3 days
Order 3: 1 day
→ Total: 6 days, 3 entries → Average: 2.0 for Planning


Example Input (Snapshot of Steps Over 5 Days)
Let’s say we track 3 orders from 20250520 to 20250524:

Order	20250520	20250521	20250522	20250523	20250524
A	Planning	Planning	Digging	Digging	RFS
B	Planning	Digging	Digging	Digging	RFS
C	Planning	Planning	Planning	Planning	Planning
Step-by-Step for Each Order
🧾 Order A:
Planning: 2 days

Digging: 2 days

RFS: 1 day

🧾 Order B:
Planning: 1 day

Digging: 3 days

RFS: 1 day

🧾 Order C:
Planning: 5 days

Aggregated Counts
Step	Total Days	Unique Orders	Avg Days
Planning	8 days	3 orders	8 / 3 ≈ 2.67
Digging	5 days	2 orders	5 / 2 = 2.50
RFS	2 days	2 orders	2 / 2 = 1.00




2. metric_avg_orders_per_day per step
For each delivery step, on average, how many orders are in that step per day over the period 

Suppose you have:

Order	20250521	20250522	20250523
A	Planning	Planning	Digging
B	Planning	Digging	Digging
C	Digging	Digging	RFS

Let’s tally up:

Step	Total Appearances
Planning	3
Digging	4
RFS	1

Number of days = 3

Avg orders per day
Planning: 3/3=1
Digging: 4/3=1.33
RFS: 1/3=0.33

This metric helps you answer:
"Which step has the most sustained volume?"
"Where are orders lingering long enough to clog the system?"


Concrete example
Let’s say:

Your file covers 3 days (20250521 to 20250523)

Here’s what the order timeline looks like:

Order	20250521	20250522	20250523
A	Planning	Planning	Digging
B	Planning	Digging	Digging
C	Digging	Digging	RFS

Let’s look at how many orders were in Digging per day:

Date	Orders in Digging
20250521	1 (Order C)
20250522	2 (Orders B, C)
20250523	2 (Orders A, B)

Add them up:
1 + 2 + 2 = 5 total Digging entries across 3 days
~1.67 orders in progress on any given day across the 3-day period.

Meaning, in average 1.67 orders being processed each day - indicates traffic



Example Input (3 Days)
Order	20250521	20250522	20250523
A	Planning	Planning	Digging
B	Planning	Digging	Digging
C	Digging	Digging	RFS

 Step-by-Step Tally of Step Appearances
We count how many orders were in each step on each day:

20250521:
Planning: A, B → 2

Digging: C → 1

20250522:
Planning: A → 1

Digging: B, C → 2

20250523:
Digging: A, B → 2

RFS: C → 1

 Total Step Appearances Over 3 Days
Step	Total Occurrences	Number of Days	Avg Orders per Day
Planning	3	3	3 / 3 = 1.00
Digging	5	3	5 / 3 ≈ 1.67
RFS	1	3	1 / 3 ≈ 0.33


3. Averge mrc per day per step

For each delivery step, on average, how much MRC is concentrated in that step per day over the snapshot period.


Assume you have a table with 3 snapshot days:

Order	Delta MRC	20250521	20250522	20250523
A	100	Planning	Planning	Digging
B	300	Planning	Digging	Digging
C	600	Digging	Digging	RFS

🔹 20250521:
A in Planning → +100

B in Planning → +300

C in Digging → +600
→ Totals: Planning = 400, Digging = 600

🔹 20250522:
A in Planning → +100

B in Digging → +300

C in Digging → +600
→ Totals: Planning = 100, Digging = 900

🔹 20250523:
A in Digging → +100

B in Digging → +300

C in RFS → +600
→ Totals: Digging = 400, RFS = 600

📊 Summing Across All Days
Step	Total MRC
Planning	400 + 100 = 500
Digging	600 + 900 + 400 = 1900
RFS	600

Number of days = 3

📈 Average MRC per Day
Step	Avg MRC per Day
Planning	500 / 3 = 166.67
Digging	1900 / 3 = 633.33
RFS	600 / 3 = 200.00

This metric answers:

Where is the monetary value piling up over time?

Example Input
Let’s assume this structure for 3 days:

Order	Delta MRC	20250521	20250522	20250523
A	100	Planning	Planning	Digging
B	300	Planning	Digging	Digging
C	600	Digging	Digging	RFS

Day-by-Day Tally of MRC per Step
🧾 20250521:
Planning: A (100) + B (300) = 400

Digging: C (600)

🧾 20250522:
Planning: A (100)

Digging: B (300) + C (600) = 900

🧾 20250523:
Digging: A (100) + B (300) = 400

RFS: C (600)

Total MRC Across 3 Days
Step	Total MRC	Days	Avg MRC per Day
Planning	500	3	500 / 3 = 166.67
Digging	1900	3	1900 / 3 ≈ 633.33
RFS	600	3	600 / 3 = 200.00


4. Orders in and out

For each step and for a time window from T1 to T2, count:
How many unique orders entered that step
How many stayed in that step the entire time
How many exited the step


Input Data (Step History per Order)
Order	20250521	20250522	20250523
A	Planning	Planning	Digging
B	Planning	Digging	Digging
C	Digging	Digging	RFS
D	Digging	Digging	Digging
E	Planning	Digging	RFS

Step-by-Step Classification for Step = Digging
Order	Step Sequence	At T1	At T2	In Step at Any Point?	Entered	Stayed	Exited
A	[Planning, Planning, Digging]	Planning	Digging	✅	✅	❌	❌
B	[Planning, Digging, Digging]	Planning	Digging	✅	✅	❌	❌
C	[Digging, Digging, RFS]	Digging	RFS	✅	❌	❌	✅
D	[Digging, Digging, Digging]	Digging	Digging	✅	❌	✅	❌
E	[Planning, Digging, RFS]	Planning	RFS	✅	✅	❌	✅

Final Tally for Step = Digging
Metric	Orders	Count
Entered	A, B, E	3
Stayed	D	1
Exited	C, E	2
