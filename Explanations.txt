To-do: Link delivered MRC with the Order Development Output sheet
Flow analysis



1. metric_avg_days_in_step

It's calculating, per delivery step, the average number of consecutive days an order spends in that step before transitioning to a new one.
It loops through each row (i.e., each order), looks across all the daily columns, and counts how long an order stays in the same step, like this:

Cabling  â†’ Cabling â†’ Cabling â†’ Activation â†’ Activation â†’ RFS
           â†‘      â†‘      â†‘        â†‘         â†‘         â†‘
         Day 1   2      3       4         5         6


In this case:
Cabling = 3 days
Activation = 2 days
RFS = 1 day

These durations are added to totals per step

Another example:
If 50 orders each spend 3 days in a step â†’ average is 3
If 10 orders spend 1 day, 10 spend 5 â†’ average = (10Ã—1 + 10Ã—5) / 20 = 3

Order	Timeline
001	Planning â†’ Planning â†’ Digging
002	Planning â†’ Planning â†’ Planning
003	Planning â†’ Digging â†’ Digging

For Planning:
Order 1: 2 days
Order 2: 3 days
Order 3: 1 day
â†’ Total: 6 days, 3 entries â†’ Average: 2.0 for Planning



2. metric_avg_orders_per_day per step
For each delivery step, on average, how many orders are in that step per day over the period 

uppose you have:

Order	20250521	20250522	20250523
A	Planning	Planning	Digging
B	Planning	Digging	Digging
C	Digging	Digging	RFS

Letâ€™s tally up:

Step	Total Appearances
Planning	3
Digging	4
RFS	1

Number of days = 3

Avg orders per day
Planning: 3/3=1
Digging: 4/3=1.33
RFS: 1/3=0.33

This metric helps you answer:
"Which step has the most sustained volume?"
"Where are orders lingering long enough to clog the system?"



Concrete example
Letâ€™s say:

Your file covers 3 days (20250521 to 20250523)

Hereâ€™s what the order timeline looks like:

Order	20250521	20250522	20250523
A	Planning	Planning	Digging
B	Planning	Digging	Digging
C	Digging	Digging	RFS

Letâ€™s look at how many orders were in Digging per day:

Date	Orders in Digging
20250521	1 (Order C)
20250522	2 (Orders B, C)
20250523	2 (Orders A, B)

Add them up:
1 + 2 + 2 = 5 total Digging entries across 3 days
~1.67 orders in progress on any given day across the 3-day period.

Meaning, in average 1.67 orders being processed each day - indicates traffic

3. Averge mrc per day per step

For each delivery step, on average, how much MRC is concentrated in that step per day over the snapshot period.


Assume you have a table with 3 snapshot days:

Order	Delta MRC	20250521	20250522	20250523
A	100	Planning	Planning	Digging
B	300	Planning	Digging	Digging
C	600	Digging	Digging	RFS

ðŸ”¹ 20250521:
A in Planning â†’ +100

B in Planning â†’ +300

C in Digging â†’ +600
â†’ Totals: Planning = 400, Digging = 600

ðŸ”¹ 20250522:
A in Planning â†’ +100

B in Digging â†’ +300

C in Digging â†’ +600
â†’ Totals: Planning = 100, Digging = 900

ðŸ”¹ 20250523:
A in Digging â†’ +100

B in Digging â†’ +300

C in RFS â†’ +600
â†’ Totals: Digging = 400, RFS = 600

ðŸ“Š Summing Across All Days
Step	Total MRC
Planning	400 + 100 = 500
Digging	600 + 900 + 400 = 1900
RFS	600

Number of days = 3

ðŸ“ˆ Average MRC per Day
Step	Avg MRC per Day
Planning	500 / 3 = 166.67
Digging	1900 / 3 = 633.33
RFS	600 / 3 = 200.00

This metric answers:

Where is the monetary value piling up over time?